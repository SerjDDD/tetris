(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(25)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var l,u,r,i=n(0),a=n.n(i),o=n(11),c=n.n(o),s=(n(19),n(8)),m=n(9),f=n(2),h=n(3),d=n(5),v=n(4),p=n(1),b=n(6),O=n(12),g=n.n(O),j=n(7),T=[40,100,300,1200];!function(e){e[e.UP=38]="UP",e[e.DOWN=40]="DOWN",e[e.LEFT=37]="LEFT",e[e.RIGHT=39]="RIGHT",e[e.ROTATE_LEFT=90]="ROTATE_LEFT",e[e.ROTATE_RIGHT=88]="ROTATE_RIGHT",e[e.SELECT=16]="SELECT",e[e.ENTER=13]="ENTER"}(u||(u={})),function(e){e[e.I=0]="I",e[e.J=1]="J",e[e.L=2]="L",e[e.O=3]="O",e[e.S=4]="S",e[e.T=5]="T",e[e.Z=6]="Z"}(r||(r={}));var y,E=r,L=(l={},Object(j.a)(l,r.I,[[[E.I,E.I,E.I,E.I],[null,null,null,null],[null,null,null,null],[null,null,null,null]],[[null,E.I,null,null],[null,E.I,null,null],[null,E.I,null,null],[null,E.I,null,null]]]),Object(j.a)(l,r.J,[[[E.J,null,null,null],[E.J,E.J,E.J,null],[null,null,null,null],[null,null,null,null]],[[null,E.J,E.J,null],[null,E.J,null,null],[null,E.J,null,null],[null,null,null,null]],[[E.J,E.J,E.J,null],[null,null,E.J,null],[null,null,null,null],[null,null,null,null]],[[null,E.J,null,null],[null,E.J,null,null],[E.J,E.J,null,null],[null,null,null,null]]]),Object(j.a)(l,r.L,[[[null,null,E.L,null],[E.L,E.L,E.L,null],[null,null,null,null],[null,null,null,null]],[[null,E.L,null,null],[null,E.L,null,null],[null,E.L,E.L,null],[null,null,null,null]],[[E.L,E.L,E.L,null],[E.L,null,null,null],[null,null,null,null],[null,null,null,null]],[[E.L,E.L,null,null],[null,E.L,null,null],[null,E.L,null,null],[null,null,null,null]]]),Object(j.a)(l,r.O,[[[null,E.O,E.O,null],[null,E.O,E.O,null],[null,null,null,null],[null,null,null,null]]]),Object(j.a)(l,r.S,[[[null,E.S,E.S,null],[E.S,E.S,null,null],[null,null,null,null],[null,null,null,null]],[[null,E.S,null,null],[null,E.S,E.S,null],[null,null,E.S,null],[null,null,null,null]]]),Object(j.a)(l,r.T,[[[null,E.T,null,null],[E.T,E.T,E.T,null],[null,null,null,null],[null,null,null,null]],[[null,E.T,null,null],[null,E.T,E.T,null],[null,E.T,null,null],[null,null,null,null]],[[E.T,E.T,E.T,null],[null,E.T,null,null],[null,null,null,null],[null,null,null,null]],[[null,E.T,null,null],[E.T,E.T,null,null],[null,E.T,null,null],[null,null,null,null]]]),Object(j.a)(l,r.Z,[[[E.Z,E.Z,null,null],[null,E.Z,E.Z,null],[null,null,null,null],[null,null,null,null]],[[null,null,E.Z,null],[null,E.Z,E.Z,null],[null,E.Z,null,null],[null,null,null,null]]]),l),S=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],k=(n(20),function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.field;return i.createElement("table",{className:"tetris-field",cellSpacing:0,cellPadding:0},i.createElement("tbody",null,e.map(function(e,t){return i.createElement("tr",{key:"line".concat(t),className:"tetris-field-line"},e.map(function(e,n){var l="".concat(t,"x").concat(n),u=g()({"tetris-field-cell":!0,"cell-i":e===r.I,"cell-j":e===r.J,"cell-l":e===r.L,"cell-o":e===r.O,"cell-s":e===r.S,"cell-t":e===r.T,"cell-z":e===r.Z,"cell-null":null===e});return i.createElement("td",{key:l,className:u})}))})))}}]),t}(i.PureComponent)),w=(n(21),function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.createElement("section",{className:"tetris-wins"},i.createElement("span",{role:"img","aria-label":"life"},"\u2764\ufe0f\u2764\ufe0f\u2764\ufe0f"))}}]),t}(i.PureComponent)),R=(n(22),function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(d.a)(this,Object(v.a)(t).call(this,e))).tetrisBoxElement=void 0,n.updateDimensions=n.updateDimensions.bind(Object(p.a)(n)),n.tetrisBoxElement=i.createRef(),n.state={height:null,width:null},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"updateDimensions",value:function(){var e=this;this.setState(function(t,n){var l=e.tetrisBoxElement.current;if(null===l||void 0===n.adjustSize)return t;var u=window.getComputedStyle(l,null),r=parseInt(u.getPropertyValue("height")),i=parseInt(u.getPropertyValue("width"));return n.adjustSize(r,i)})}},{key:"componentDidMount",value:function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"render",value:function(){var e=this.props,t=e.color,n=e.flex,l=this.state,u={color:t,borderColor:t,flex:!0===n?1:0,height:l.height||void 0,width:l.width||void 0};return i.createElement("section",{className:"tetris-box",style:u,ref:this.tetrisBoxElement},this.props.children)}}]),t}(i.PureComponent)),x=function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.score;return i.createElement(R,null,i.createElement("p",null,"SCORE"),i.createElement("p",null,String.prototype.padStart.call(e>=999999?999999:e,6,"0")))}}]),t}(i.PureComponent),F=function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.lines;return i.createElement(R,null,i.createElement("p",null,"LINES"),i.createElement("p",null,String.prototype.padStart.call(e>=999?999:e,3,"0")))}}]),t}(i.PureComponent),I=function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.level;return i.createElement(R,null,i.createElement("p",null,"LEVEL"),i.createElement("p",null,String.prototype.padStart.call(e>=99?99:e,2,"0")))}}]),t}(i.PureComponent),C=(n(23),function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.tetromino;return i.createElement(R,null,i.createElement("p",null,"NEXT"),i.createElement(k,{field:e}),i.createElement("div",{style:{marginTop:"50%"}}))}}]),t}(i.PureComponent)),A=function(e){function t(){return Object(f.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.burn,n=e.iago,l=e.rate;return n>12?i.createElement(R,{color:"#ff0000"},i.createElement("p",null,"I AGO"),i.createElement("p",null,String.prototype.padStart.call(n,3,"0"))):t>0?i.createElement(R,null,i.createElement("p",null,"BURN"),i.createElement("p",null,String.prototype.padStart.call(t,3,"0"))):i.createElement(R,null,i.createElement("p",null,"TRATE"),i.createElement("p",null,"".concat(String.prototype.padStart.call(l,2,"0"),"%")))}}]),t}(i.PureComponent);!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(y||(y={}));var N=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(d.a)(this,Object(v.a)(t).call(this,e))).tetrisElement=void 0,n.framesCount=0,n.generateField=n.generateField.bind(Object(p.a)(n)),n.getFieldWithActiveTetromino=n.getFieldWithActiveTetromino.bind(Object(p.a)(n)),n.removeLines=n.removeLines.bind(Object(p.a)(n)),n.calculateScore=n.calculateScore.bind(Object(p.a)(n)),n.getCurrentLevel=n.getCurrentLevel.bind(Object(p.a)(n)),n.getActiveTetrominoShape=n.getActiveTetrominoShape.bind(Object(p.a)(n)),n.getNextTetrominoShape=n.getNextTetrominoShape.bind(Object(p.a)(n)),n.getRandomTetromino=n.getRandomTetromino.bind(Object(p.a)(n)),n.createTetromino=n.createTetromino.bind(Object(p.a)(n)),n.getBufferLeft=n.getBufferLeft.bind(Object(p.a)(n)),n.getBufferRight=n.getBufferRight.bind(Object(p.a)(n)),n.getBufferDown=n.getBufferDown.bind(Object(p.a)(n)),n.moveLeft=n.moveLeft.bind(Object(p.a)(n)),n.moveRight=n.moveRight.bind(Object(p.a)(n)),n.moveDown=n.moveDown.bind(Object(p.a)(n)),n.rotateLeft=n.rotateLeft.bind(Object(p.a)(n)),n.rotateRight=n.rotateRight.bind(Object(p.a)(n)),n.shiftTetromino=n.shiftTetromino.bind(Object(p.a)(n)),n.hasOverlaps=n.hasOverlaps.bind(Object(p.a)(n)),n.keyPressed=n.keyPressed.bind(Object(p.a)(n)),n.getFramesPerLevel=n.getFramesPerLevel.bind(Object(p.a)(n)),n.processFrame=n.processFrame.bind(Object(p.a)(n)),n.play=n.play.bind(Object(p.a)(n)),n.stop=n.stop.bind(Object(p.a)(n)),n.pause=n.pause.bind(Object(p.a)(n)),n.adjustFieldSize=n.adjustFieldSize.bind(Object(p.a)(n)),n.adjustNextTetrominoSize=n.adjustNextTetrominoSize.bind(Object(p.a)(n)),n.tetrisElement=i.createRef(),n.state={burn:0,field:n.generateField(),iago:0,level:e.startLevel,lines:0,nextTetromino:null,paused:!0,score:0,tetrisLines:0,tetromino:null},n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"generateField",value:function(){var e=this.props,t=e.fieldHeight,n=e.fieldWidth;return new Array(t).fill(void 0).map(function(){return new Array(n).fill(null)})}},{key:"getFieldWithActiveTetromino",value:function(){var e=this.state,t=e.field,n=e.tetromino;if(null===n)return t;var l=this.getActiveTetrominoShape();return t.map(function(e,t){return e.map(function(e,u){return null!==e?e:t>=n.y&&t<n.y+l.length&&u>=n.x&&u<n.x+l[t-n.y].length?l[t-n.y][u-n.x]:null})})}},{key:"removeLines",value:function(e){var t=this.generateField(),n=e.filter(function(e){return!e.every(function(e){return null!==e})}),l=this.props.startLevel,u=this.state,r=u.burn,i=u.lines,a=u.tetrisLines,o=u.score,c=20-n.length,s=[].concat(Object(m.a)(t),Object(m.a)(n)).reverse().slice(0,20).reverse(),f=i+c,h=4===c?a+c:a,d=this.getCurrentLevel(l,f);return{burn:c?4===c?0:r+c:r,field:s,lines:f,level:d,tetrisLines:h,score:o+this.calculateScore(d,c)}}},{key:"calculateScore",value:function(e,t){return 0===t?0:T[t-1]*(e+1)}},{key:"getCurrentLevel",value:function(e,t){var n=10*e+10,l=Math.max(100,10*e-50),u=t-Math.min(n,l);return u<0?e:e+Math.floor(u/10)+1}},{key:"getActiveTetrominoShape",value:function(){var e=this.state.tetromino;return null===e?S:L[e.type][e.state]}},{key:"getNextTetrominoShape",value:function(){var e=this.state.nextTetromino;return null===e?S:L[e][0].filter(function(e,t){return t<2})}},{key:"getRandomTetromino",value:function(){return Math.floor(7*Math.random())}},{key:"createTetromino",value:function(e){return{type:e,state:0,x:3,y:0}}},{key:"getBufferLeft",value:function(e){return e.reduce(function(e,t){var n=t.findIndex(function(e){return null!==e});return-1===n?e:Math.min(e,n)},4)}},{key:"getBufferRight",value:function(e){return e.reduce(function(e,t){var n=Object(m.a)(t).reverse().findIndex(function(e){return null!==e});return-1===n?e:Math.min(e,n)},4)}},{key:"getBufferDown",value:function(e){for(var t=0,n=e.length-1;n>=0;n-=1){if(-1!==e[n].findIndex(function(e){return null!==e}))break;t+=1}return t}},{key:"moveLeft",value:function(){var e=this;this.setState(function(t,n){if(null===t.tetromino)return t;var l=Object(s.a)({},t.tetromino),u=e.getActiveTetrominoShape(),r=e.getBufferLeft(u);return l.x+r>0&&(l.x-=1),e.hasOverlaps(l)?t:{tetromino:l}})}},{key:"moveRight",value:function(){var e=this;this.setState(function(t,n){if(null===t.tetromino)return t;var l=Object(s.a)({},t.tetromino),u=e.getActiveTetrominoShape(),r=e.getBufferRight(u);return l.x<n.fieldWidth+r-4&&(l.x+=1),e.hasOverlaps(l)?t:{tetromino:l}})}},{key:"moveDown",value:function(){var e=this;this.setState(function(t,n){if(null===t.tetromino)return t;var l=Object(s.a)({},t.tetromino),u=e.getActiveTetrominoShape(),r=e.getBufferDown(u);return n.fieldHeight+r-(l.y+4)-1>=0?(l.y+=1,e.hasOverlaps(l)?Object(s.a)({},e.removeLines(e.getFieldWithActiveTetromino()),{tetromino:null}):{field:t.field,tetromino:l}):Object(s.a)({},e.removeLines(e.getFieldWithActiveTetromino()),{tetromino:null})})}},{key:"rotateLeft",value:function(){var e=this;this.setState(function(t,n){if(null===t.tetromino)return t;var l=Object(s.a)({},t.tetromino),u=L[l.type].length-1;return l.state=0===l.state?u:l.state-1,l=e.shiftTetromino(l),e.hasOverlaps(l)?t:{tetromino:l}})}},{key:"rotateRight",value:function(){var e=this;this.setState(function(t,n){if(null===t.tetromino)return t;var l=Object(s.a)({},t.tetromino),u=L[l.type].length-1;return l.state=l.state===u?0:l.state+1,l=e.shiftTetromino(l),e.hasOverlaps(l)?t:{tetromino:l}})}},{key:"shiftTetromino",value:function(e){var t=this.props.fieldWidth,n=L[e.type][e.state],l=this.getBufferLeft(n);e.x+l<0&&(e.x=0);var u=this.getBufferRight(n);return e.x>t+u-4&&(e.x=t+u-4),e}},{key:"hasOverlaps",value:function(e){for(var t=this.state.field,n=L[e.type][e.state],l=0,u=n.length;l<u;l+=1)for(var r=0,i=n[l].length;r<i;r+=1)if(null!==n[l][r]){var a=t[e.y+l][e.x+r];if(null!==a&&void 0!==a)return!0}return!1}},{key:"keyPressed",value:function(e){if(!this.state.paused||e.keyCode===u.ENTER||e.keyCode===u.SELECT)switch(e.keyCode){case u.LEFT:this.moveLeft();break;case u.RIGHT:this.moveRight();break;case u.UP:this.rotateRight();break;case u.DOWN:this.moveDown();break;case u.ROTATE_LEFT:this.rotateLeft();break;case u.ROTATE_RIGHT:this.rotateRight();break;case u.SELECT:break;case u.ENTER:this.pause()}}},{key:"getFramesPerLevel",value:function(e){return 0===e?48:1===e?43:2===e?38:3===e?33:4===e?28:5===e?23:6===e?18:7===e?13:8===e?8:9===e?6:e>=10&&e<=12?5:e>=13&&e<=15?4:e>=16&&e<=18?3:e>=19&&e<=28?2:e>=29?1:60}},{key:"processFrame",value:function(){var e=this.state,t=e.level,n=e.paused;this.framesCount+=1;var l=this.getFramesPerLevel(t);this.framesCount>=l?(this.framesCount=0,this.moveDown(),this.play()):!1===n&&requestAnimationFrame(this.processFrame)}},{key:"play",value:function(){var e=this,t=this.state,n=t.paused,l=t.tetromino;!0===n&&this.setState(function(e,t){return{paused:!1}}),null===l&&this.setState(function(t,n){var l=e.createTetromino(null===t.nextTetromino?e.getRandomTetromino():t.nextTetromino);return{iago:l.type===r.I?0:t.iago+1,nextTetromino:e.getRandomTetromino(),paused:e.hasOverlaps(l),tetromino:l}}),requestAnimationFrame(this.processFrame)}},{key:"stop",value:function(){this.setState(function(e,t){return{paused:!0}})}},{key:"pause",value:function(){this.state.paused?this.play():this.stop()}},{key:"adjustFieldSize",value:function(e,t){return{height:null,width:e/20*10}}},{key:"adjustNextTetrominoSize",value:function(e,t){return{height:t/2,width:null}}},{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.keyPressed)}},{key:"componentWillUnmount",value:function(){this.stop(),window.removeEventListener("keydown",this.keyPressed)}},{key:"render",value:function(){var e=this.state,t=e.burn,n=e.iago,l=e.level,u=e.lines,r=e.tetrisLines,a=e.score,o=u?Math.round(r/u*100):u;return i.createElement("section",{className:"tetris",ref:this.tetrisElement},i.createElement("section",{className:"tetris-main-section"},i.createElement(R,{flex:!0,adjustSize:this.adjustFieldSize},i.createElement(k,{field:this.getFieldWithActiveTetromino()})),i.createElement(R,null,i.createElement(w,null))),i.createElement("aside",null,i.createElement(x,{score:a}),i.createElement(C,{tetromino:this.getNextTetrominoShape()}),i.createElement(I,{level:l}),i.createElement(F,{lines:u}),i.createElement(A,{burn:t,iago:n,rate:o})))}}]),t}(i.PureComponent),P=(n(24),function(){return a.a.createElement("main",{className:"app"},a.a.createElement(N,{fieldHeight:20,fieldWidth:10,startLevel:0}))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[13,1,2]]]);
//# sourceMappingURL=main.79510a22.chunk.js.map